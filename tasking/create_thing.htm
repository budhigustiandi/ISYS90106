<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>OGC SensorThings API - Create Thing</title>
	<link rel="stylesheet" href="tasking.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
</head>
<body>
	<h1>Create Thing</h1>
	<h2>Mandatory</h2>
	<p id="thing_name_title">name</p>
	<textarea id="thing_name" rows="1" placeholder="String"></textarea>
	<p id="thing_description_title">description</p>
	<textarea id="thing_description" rows="1" placeholder="String"></textarea>
	<h2>Optional</h2>
	<p id="thing_properties_title">properties</p>
	<textarea id="thing_property" rows="3" placeholder="JSON"></textarea>
	<button id="create_thing" onclick="createThing();">Create Thing</button>
	<button id="create_thing" onclick="updateThing();">Update Thing</button>
	<script>
		function createThing(){
			var thing_name = document.querySelector("#thing_name").value;			
			if (thing_name === "") {
				document.querySelector("#thing_name_title").innerHTML = 'name <span style="color: red">Please provide a name!</span>'
			} else {
				document.querySelector("#thing_name_title").innerHTML = 'name'
				console.log("Thing Name: " + thing_name);
			}
			var thing_description = document.querySelector("#thing_description").value;
			if (thing_description === "") {
				document.querySelector("#thing_description_title").innerHTML = 'description <span style="color: red">Please provide a description!</span>'
			} else {
				document.querySelector("#thing_description_title").innerHTML = 'description'
				console.log("Thing Description: " + thing_description);
			}
			if (thing_name !== "" && thing_description !== "") {
				var thing = '{ "name": "' + thing_name + '", "description": "' + thing_description + '"';
			}
			var thing_property = document.querySelector("#thing_property").value;
			if (thing_property !== "") {
				thing = thing + ', "properties" : ' + thing_property;
				console.log("Thing Properties: " + thing_property);
			}
			thing = thing + ' }';
			console.log("Thing: " + thing);
			if (thing_name !== "" && thing_description !== "") {
				$.ajax({
					url: "https://scratchpad.sensorup.com/OGCSensorThings/v1.0/Things",
					type: "POST",
					data: thing,
					contentType: "application/json; charset=utf-8",
					success: function(data){
						console.log(data);  
					},
					error: function(response, status){
						console.log(response);
						console.log(status);
					}
				});
			}
			// Example how to add a child into a tag
			var thing_id_node = document.createElement("H2");
			var thing_id_text = document.createTextNode("Thing ID: 773288");
			thing_id_node.appendChild(thing_id_text);
			document.querySelector("body").appendChild(thing_id_node);
			// =====================================
		}
		function updateThing(){
			var thing_name = document.querySelector("#thing_name").value;			
			if (thing_name === "") {
				document.querySelector("#thing_name_title").innerHTML = 'name <span style="color: red">Please provide a name!</span>'
			} else {
				document.querySelector("#thing_name_title").innerHTML = 'name'
				console.log("Thing Name: " + thing_name);
			}
			var thing_description = document.querySelector("#thing_description").value;
			if (thing_description === "") {
				document.querySelector("#thing_description_title").innerHTML = 'description <span style="color: red">Please provide a description!</span>'
			} else {
				document.querySelector("#thing_description_title").innerHTML = 'description'
				console.log("Thing Description: " + thing_description);
			}
			if (thing_name !== "" && thing_description !== "") {
				var thing = '{ "name": "' + thing_name + '", "description": "' + thing_description + '"';
			}
			var thing_property = document.querySelector("#thing_property").value;
			if (thing_property !== "") {
				thing = thing + ', "properties" : ' + thing_property;
				console.log("Thing Properties: " + thing_property);
			}
			thing = thing + ' }';
			console.log("Thing: " + thing);
			$.ajax({
				url: "https://scratchpad.sensorup.com/OGCSensorThings/v1.0/Things(1785996)",
				type: "PATCH",
				data: thing,
				contentType: "application/json; charset=utf-8",
				success: function(data){
					console.log(data);
				},
				error: function(response, status){
					console.log(response);
					console.log(status);
				}
			});
		}
	</script>
</body>
</html>